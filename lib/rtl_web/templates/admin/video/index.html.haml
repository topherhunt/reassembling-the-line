%h1 Code videos

.row
  .col-sm-6
    %p We "code" each video by tagging any interesting segments so that viewers can easily jump to topics that they care about and don't need to watch each entire video.

    %p All videos are listed below, with the most recently coded first. Uncoded videos are at the bottom.
  .col-sm-6
    - if @next_uncoded_video do
      = link icon_and_text("pricetags", "Code the next video"), to: admin_coding_path(@conn, :new, video_id: @next_uncoded_video.id), class: "btn btn-primary"

%table.table.table-striped
  %tr
    %th
    %th Title
    %th Source
    %th Status
    %th
  - Enum.map @videos, fn(video) ->
    %tr
      %td{style: "padding: 2px;"}
        %div{style: "height: 80px; width: 80px; overflow: hidden; border-radius: 5px;"}
          %div{style: "height: 100%; width: 200%; margin-left: -50%;"}
            %img{src: "#{RTL.Videos.thumbnail_url(video)}", style: "display: block; height: 100%; margin: 0 auto 0 auto;"}
      %td= video.title
      %td= link_to_source(video)
      - if video.coding do
        %td
          .small
            -# TODO: If I put these two text statements on one line (e.g. Coded by #{...} on #{...}), the parser for some reason drops everything before the word "on". Figure out how to make phoenix_haml more reliable or revert to eex.
            Coded by #{video.coding.updated_by_user.full_name}
            on #{RTLWeb.DateHelpers.print_date(video.coding.updated_at)}
          - if length(tag_list(video)) > 0 do
            .small
              Tags:
              = Enum.join(tag_list(video), ", ")
        %td
          = link "recode", to: admin_coding_path(@conn, :edit, video.coding.id), class: "text-warning"
          &nbsp;
          = link icon("trash"), to: admin_video_path(@conn, :delete, video.id), class: "text-danger", "data-tooltip": "Delete this video", "data-confirmation": "Are you sure you want to delete this video and its coding data?"
      - else
        %td.text-muted Not coded
        %td= link "code", to: admin_coding_path(@conn, :new, video_id: video.id), class: "btn btn-sm btn-outline-primary"
        %td

